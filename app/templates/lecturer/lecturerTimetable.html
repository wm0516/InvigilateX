{% extends "lecturer/lecturerBase.html" %}
{% block title %}Lecturer Timetable{% endblock %}

{% block content %}
<div class="menu-section">
    <h2>My Teaching Timetable</h2>

    <div class="timetable-container">
        <!-- Header Row: Days (X-axis) -->
        <div class="timetable-row timetable-header">
            <div class="timetable-time-label">Time / Day</div>
            {% set days = ["MON", "TUE", "WED", "THU", "FRI"] %}
            {% for day in days %}
                <div class="timetable-day">{{ day }}</div>
            {% endfor %}
        </div>

        <!-- Rows for Time (Y-axis) -->
        {% for hour in range(7, 24) %}
            <div class="timetable-row">
                <div class="timetable-time-label">{{ "%02d:00"|format(hour) }}</div>

                {% for day in days %}
                    <div class="timetable-cell">
                        {% for row in timetable_rows %}
                            {% if row.classDay|upper == day %}
                                {% set start_hour = row.classTime.split('-')[0].split(':')[0] | int %}
                                {% set start_minute = row.classTime.split('-')[0].split(':')[1] | int %}
                                {% set end_hour = row.classTime.split('-')[1].split(':')[0] | int %}
                                {% set end_minute = row.classTime.split('-')[1].split(':')[1] | int %}

                                {% set start_decimal = start_hour + (start_minute / 60) %}
                                {% set end_decimal = end_hour + (end_minute / 60) %}
                                
                                {% if hour == start_hour %}
                                    {% set duration = (end_decimal - start_decimal) %}
                                    <div class="class-block" style="height:{{  duration * 50 }}px;">
                                        <strong>{{ row.courseName }}</strong><br>
                                        [{{ row.classType }}]<br>
                                        <i>{{ row.classRoom }}</i><br>
                                        <span>{{ row.classTime }}</span>
                                        <hr>
                                        <div class="course-details">
                                            {% for i in range(row.courseIntakes|length) %}
                                                <small>
                                                    {{ row.courseIntakes[i] }} | {{ row.courseCodes[i] }} | {{ row.courseSections[i] }}
                                                </small><br>
                                            {% endfor %}
                                        </div>
                                    </div>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
