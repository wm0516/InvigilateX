{% extends "lecturer/lecturerBase.html" %}
{% block title %}Lecturer Timetable{% endblock %}
{% block content %}
<div class="menu-section">
    <h2>Lecturer Timetable</h2>

    <div class="user-table-container">
        <table class="user-data-table" border="1">
            <thead>
                <tr>
                    <th>Day / Time</th>
                    {% set time_slots = ["07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"] %}
                    {% for time in time_slots %}
                        <th>{{ time }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for day in ["MON", "TUE", "WED", "THU", "FRI"] %}
                <tr>
                    <td><strong>{{ day }}</strong></td>
                    {% set skip = 0 %}

                    {% for time in time_slots %}
                        {% if skip > 0 %}
                            {% set skip = skip - 1 %}
                        {% else %}
                            {% set class_block = None %}
                            {% set duration = 1 %}
                            {% for row in timetable_rows %}
                                {% if row.classDay == day %}
                                    {% set time_range = row.classTime.split('-') %}
                                    {% set start = time_range[0].strip() %}
                                    {% set end = time_range[1].strip() %}
                                    {% if time == start %}
                                        {% set start_hour = start.split(':')[0]|int %}
                                        {% set end_hour = end.split(':')[0]|int %}
                                        {% set duration = end_hour - start_hour %}
                                        {% set class_block = row %}
                                        {% set skip = duration - 1 %}
                                    {% endif %}
                                {% endif %}
                            {% endfor %}

                            {% if class_block %}
                                <td colspan="{{ duration }}">
                                    <div style="border:1px solid #ccc; padding:6px; background:#f8f9fa; border-radius:6px; text-align:center;">
                                        <strong>{{ class_block.courseName }}</strong><br>
                                        [{{ class_block.classType }}]<br>
                                        Room: {{ class_block.classRoom }}<br>
                                        <small>{{ class_block.classTime }}</small><br>
                                        {% if class_block.courseIntakes %}
                                            <small>Intakes: {{ class_block.courseIntakes | join(', ') }}</small><br>
                                        {% endif %}
                                        {% if class_block.courseCodes %}
                                            <small>Codes: {{ class_block.courseCodes | join(', ') }}</small><br>
                                        {% endif %}
                                        {% if class_block.courseSections %}
                                            <small>Sections: {{ class_block.courseSections | join(', ') }}</small><br>
                                        {% endif %}
                                    </div>
                                </td>
                            {% else %}
                                <td></td>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
