{% extends "lecturer/lecturerBase.html" %}
{% block title %}Lecturer Timetable{% endblock %}

{% block content %}
<div class="menu-section">
    <h2>My Teaching Timetable</h2>

    <div class="timetable-container">
        <!-- Header Row -->
        <div class="timetable-row timetable-header">
            <div class="timetable-time-label">Time / Day</div>
            {% set days = ["MON", "TUE", "WED", "THU", "FRI"] %}
            {% for day in days %}
                <div class="timetable-cell" style="text-align: center;">{{ day }}</div>
            {% endfor %}
        </div>

        <!-- Time Rows -->
        {% for hour in range(7, 24) %}
        <div class="timetable-row">
            <div class="timetable-time-label">{{ "%02d:00"|format(hour) }}</div>

            {% for day in days %}
            <div class="timetable-cell">
                {% set has_class = false %}
                {% for row in timetable_rows %}
                    {% if row.classDay|upper == day %}
                        {% set start_hour = row.classTime.split('-')[0].split(':')[0] | int %}
                        {% if hour == start_hour %}
                            {% set has_class = true %}
                            {% set start_time = row.classTime.split('-')[0].strip() %}
                            {% set end_time = row.classTime.split('-')[1].strip() %}
                            {% set start_hour = start_time.split(':')[0] | int %}
                            {% set end_hour = end_time.split(':')[0] | int %}
                            {% set duration = end_hour - start_hour %}
                            <div class="class-block" style="--duration: {{ duration }};">
                                <strong>{{ row.courseName }}</strong><br>
                                [{{ row.classType }}]<br>
                                <i>{{ row.classRoom }}</i> | <span>{{ row.classTime }}</span>
                                <hr>
                                <div class="course-details">
                                    {% for i in range(row.courseIntakes|length) %}
                                    <small>
                                        {{ row.courseIntakes[i] }} | {{ row.courseCodes[i] }} | {{ row.courseSections[i] }}
                                    </small><br>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </div>
            {% endfor %}
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
