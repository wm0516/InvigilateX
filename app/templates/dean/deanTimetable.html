{% extends "dean/deanBase.html" %}
{% block title %}Dean Timetable{% endblock %}
{% block content %}
<div class="menu-section">
    <h2>Timetables</h2>

    {% set time_slots = ["07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"] %}
    {% set week_days = ["MON", "TUE", "WED", "THU", "FRI"] %}

    <div class="user-table-container">
        <table class="user-data-table" border="1">
            <thead>
                <tr>
                    <th>Day / Time</th>
                    {% for time in time_slots %}
                        <th>{{ time }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
            {% for day in week_days %}
                <tr>
                    <td><strong>{{ day }}</strong></td>
                    {% set i = 0 %}
                    {% while i < time_slots|length %}
                        {% set time = time_slots[i] %}
                        {% set cell_rendered = False %}
                        {% for row in timetable_rows %}
                            {% set class_day = row.classDay %}
                            {% set class_time = row.classTime %}
                            {% set start_time = class_time.split('-')[0] %}
                            {% set end_time = class_time.split('-')[1] %}
                            {% if class_day == day and time == start_time %}
                                {% set start_index = time_slots.index(start_time) %}
                                {% set end_index = time_slots.index(end_time) %}
                                {% set colspan = end_index - start_index %}
                                <td colspan="{{ colspan }}">
                                    <div style="border: 1px solid #999; margin: 2px; padding: 2px;">
                                        <strong>{{ row.lecturerName }}</strong><br>
                                        <strong>[{{ row.classType }}]</strong><br>
                                        {{ row.courseName }}<br>
                                        Room: {{ row.classRoom }}
                                    </div>
                                </td>
                                {% set i = i + colspan %}
                                {% set cell_rendered = True %}
                                {% break %}
                            {% endif %}
                        {% endfor %}
                        {% if not cell_rendered %}
                            <td></td>
                            {% set i = i + 1 %}
                        {% endif %}
                    {% endwhile %}
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
