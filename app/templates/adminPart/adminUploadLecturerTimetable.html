<!-- upload.html -->
{% extends "adminPart/adminBase.html" %}
{% block title %}Admin UploadLecturerTimetable{% endblock %}




{% block content %}
<div class="menu-section">
    <h2>Upload Lecturer Timetable</h2>
    <div class="form-frame">
        <form id="uploadLecturerForm" method="POST" enctype="multipart/form-data">
            <div class="upload-instructions">
                <p>Upload an Excel file with lecturer details. The file must:</p>
                <ul>
                    <li>Have columns in this order: Id, Name, Department, Role, Email, Contact</li>
                    <li>First row should be header (will be skipped)</li>
                    <li>Supported formats: .xlsx, .xls, .xlsm</li>
                </ul>
            </div>
            
            <div class="input-frame">
                <input type="file" id="lecturer_list" name="lecturer_file" accept=".xlsx,.xls,.xlsm" required>
            </div>
            
            <div class="button-wrapper">
                <button type="submit">Upload</button>
            </div>
            
            <!-- Result feedback areas -->
            <div id="lecturerUploadResult"></div>
            <div id="lecturerUploadErrors"></div>
        </form>
    </div>  

    <div class="table-section">
        <h2>Current Lecturer Records</h2>
        <div class="user-table-container">
            <table class="user-data-table">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>Id</th>
                        <th>Name</th>
                        <th>Department</th>
                        <th>Role</th>
                        <th>Email</th>
                        <th>Contact</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in user_data %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ row.userId }}</td>
                        <td>{{ row.userName }}</td>
                        <td>{{ row.userDepartment }}</td>
                        <td>
                            {% if row.userLevel == 1 %}
                                Lecturer
                            {% elif row.userLevel == 2 %}
                                Dean
                            {% elif row.userLevel == 3 %}
                                Admin
                            {% else %}
                                Unknown
                            {% endif %}
                        </td>
                        <td>{{ row.userEmail }}</td>
                        <td>{{ row.userContact }}</td>
                        <td>
                            {% if row.userStatus|int == 1 %}
                                <span class="status-active">Activated</span>
                            {% else %}
                                <span class="status-inactive">Deactivated</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}



{% endblock %}
