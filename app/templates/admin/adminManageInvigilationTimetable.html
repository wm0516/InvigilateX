{% extends "admin/adminBase.html" %}
{% set show_tabs = false %}
{% set show_upload = false %}
{% set show_dashboard = false %}
{% set show_manual = false %}
{% set show_edit = false %}
{% block title %}Admin ManageInvigilationTimetable{% endblock %}
{% block head_title %}<h2>Manage Invigilation Timetable</h2>{% endblock %}

{% block content %}
<div class="menu-section">
    <h3>List of All Exam Sessions Details</h3>
    <div style="display: flex; gap: 15px; align-items: center;">
        <h4>Exam Status:</h4>
        <div style="display: flex; align-items: center; gap: 5px;">
            <span style="width: 20px; height: 20px; background-color: lightgrey; display: inline-block; border-radius: 4px;"></span>
            <span>Past Exam</span>
        </div>
        <div style="display: flex; align-items: center; gap: 5px;">
            <span style="width: 20px; height: 20px; background-color: #75bdf9; display: inline-block; border-radius: 4px;"></span>
            <span>Upcoming Exam</span>
        </div>
        <div style="display: flex; align-items: center; gap: 5px;">
            <span style="width: 20px; height: 20px; background-color: #dc74f7; display: inline-block; border-radius: 4px;"></span>
            <span>Overnight Exam (Starts Today, Ends Tomorrow)</span>
        </div>
    </div><br>

    <div class="calendar-container">
        {% if calendar_data %}
            {% for date, exams in calendar_data.items() %}
                <div class="calendar-day">
                    <h3 class="calendar-date">{{ date.strftime("%A, %d %B %Y") }}</h3>
                    {% for exam in exams %}
                        <div class="exam-card" style="background-color: {% if exam.status %}#75bdf9{% else %}lightgrey{% endif %};">
                            <strong>{{ exam.course_code }}</strong> - {{ exam.course_name }}<br>
                            Venue: {{ exam.venue }}<br>
                            Time: {{ exam.start_time.strftime("%H:%M") }} - {{ exam.end_time.strftime("%H:%M") }}
                        </div>
                    {% endfor %}
                </div>
            {% endfor %}
        {% else %}
            <p>No exam data available.</p>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
document.addEventListener("DOMContentLoaded", function() {
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, '0');
    const dd = String(today.getDate()).padStart(2, '0');
    const todayId = `date-${yyyy}-${mm}-${dd}`;
    const container = document.querySelector('.calendar-container');
    const todayRow = document.getElementById(todayId);

    if (todayRow && container) {
        container.scrollTo({
            top: todayRow.offsetTop - 40,
            behavior: 'smooth'
        });
    }
});
</script>
{% endblock %}
