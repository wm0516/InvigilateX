{% extends "admin/adminBase.html" %}
{% block title %}Admin ManageInvigilationReport{% endblock %}
{% block content %}

<div class="menu-section">
    <h2>Manage Invigilation Report</h2>
    <form method="POST">  
        <h3>Insert Ratio For Each Department to Generate Invigilation Timetable</h3>
        <label>Check this part, whether each admin able to select for all or just under self</label><br>
        <lable>Try to display out all the ratio based on the department on that page instead of empty frame</lable><br>
        <label>Now able to update the ratio, but without the main function to read the lecturers flexibility</label>
    </form>

    <br><br>
    <h3>List of Lecturer Invigilation Report</h3>
    <div class="user-table-container">
        {% set counter = 1 %}
        <table class="user-data-table">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Invigilator [ID] & Name</th>
                    <th>Contact</th>
                    <th>Exam ID</th>
                    <th>Exam Course Code/Section</th>
                    <th>Exam Start</th>
                    <th>Exam End</th>
                    <th>Total of Invigilator</th>
                    <th>Check-in Time</th>
                    <th>Check-out Time</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for exam, grouped in attendances|groupby("report.exam.examId") %}
                    {% set rowspan = grouped|length %}
                    {% for att in grouped %}
                        <tr>
                            <td>{{ counter }}</td>
                            <td>[{{ att.invigilator.userId }}] {{ att.invigilator.userName }}</td>
                            <td>{{ att.invigilator.userContact }}</td>

                            {% if loop.first %}
                                <td rowspan="{{ rowspan }}">[{{ att.report.exam.examId }}]</td>
                                <td rowspan="{{ rowspan }}">{{ att.report.exam.course.courseCodeSection }}</td>
                                <td rowspan="{{ rowspan }}">
                                    {{ att.report.exam.examStartTime.strftime("%Y-%m-%d") }} <br>
                                    [{{ att.report.exam.examStartTime.strftime("%A") }}] <br>
                                    {{ att.report.exam.examStartTime.strftime("%H:%M") }}
                                </td>
                                <td rowspan="{{ rowspan }}">
                                    {{ att.report.exam.examEndTime.strftime("%Y-%m-%d") }} <br>
                                    [{{ att.report.exam.examEndTime.strftime("%A") }}] <br>
                                    {{ att.report.exam.examEndTime.strftime("%H:%M") }}
                                </td>
                                <td rowspan="{{ rowspan }}">{{ att.report.exam.examNoInvigilator }}</td>
                            {% endif %}

                            <td>{{ att.checkIn }}</td>
                            <td>{{ att.checkOut }}</td>
                            <td>{{ att.remark }}</td>
                        </tr>
                        {% set counter = counter + 1 %}
                    {% endfor %}
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% endblock %}
