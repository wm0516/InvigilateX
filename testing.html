    // Prepare data from Flask (safe JSON export)
    const floorLabels = [{{ venues_by_floor | map(attribute='floor') | map('tojson') | join(', ') }}];
    const floorData = [{{ venues_by_floor | map(attribute='count') | join(', ') }}];

    const ctxVenueFloor = document.getElementById('venueFloorPieChart').getContext('2d');
    new Chart(ctxVenueFloor, {
        type: 'pie',
        data: {
            labels: floorLabels,
            datasets: [{
                label: "Venues by Floor",
                data: floorData,
                backgroundColor: [
                    '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',
                    '#9966FF', '#FF9F40'
                ]
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'bottom' },
                tooltip: {
                    callbacks: {
                        label: function (context) {
                            let data = context.dataset.data;
                            let sum = data.reduce((a, b) => a + b, 0);
                            let value = context.parsed;
                            let percentage = ((value / sum) * 100).toFixed(1) + "%";
                            return context.label + ": " + value + " (" + percentage + ")";
                        }
                    }
                }
            }
        }
    });